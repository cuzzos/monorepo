# iOS App - Automatic Workflow

This iOS app uses **XcodeGen + UniFFI** for automatic Rust-Swift integration.

## ğŸš€ Quick Setup

### 1. Prerequisites

```bash
# Install Mint (Swift tool manager)
brew install mint

# Install XcodeGen from Mintfile (version-pinned)
cd ../../
mint bootstrap
```

### 2. Initial Build

Build Rust libraries (one-time):

```bash
cd ../shared
./build-ios.sh
```

### 3. Generate Xcode Project

```bash
cd ../ios
mint run xcodegen xcodegen generate
```

This creates `Thiccc.xcodeproj` with:
- âœ… Automatic Rust rebuilds
- âœ… Automatic UniFFI binding generation
- âœ… Pre-build scripts configured

### 4. Open & Run

```bash
open thiccc/Thiccc.xcodeproj
```

**That's it!** Hit âŒ˜R and Xcode automatically:
- Checks if Rust code changed
- Rebuilds Rust libraries if needed
- Regenerates Swift bindings
- Builds and runs the app

---

## ğŸ“ Structure

```
ios/
â”œâ”€â”€ README.md                       â† You are here
â”œâ”€â”€ project.yml                     â† XcodeGen specification
â”‚
â”œâ”€â”€ Thiccc.xcodeproj/               â† Generated by xcodegen
â”‚   â””â”€â”€ project.pbxproj             â† (regenerated as needed)
â”‚
â””â”€â”€ thiccc/                         â† Source files
    â”œâ”€â”€ Thiccc/
    â”‚   â”œâ”€â”€ ThicccApp.swift         âœ… App entry point
    â”‚   â”œâ”€â”€ CoreUniffi.swift        âœ… Rust bridge
    â”‚   â”œâ”€â”€ Views/                  âœ… SwiftUI views
    â”‚   â”œâ”€â”€ Assets.xcassets/        âœ… Assets
    â”‚   â””â”€â”€ Generated/              âœ… UniFFI bindings (auto-generated)
    â””â”€â”€ Thiccc.xcodeproj/
```

---

## ğŸ”§ Daily Workflow

### Make Rust Changes

```bash
cd ../shared
vim src/lib.rs  # Edit Rust code
```

### Build in Xcode

```bash
open thiccc/Thiccc.xcodeproj
# Hit âŒ˜R - everything rebuilds automatically!
```

**No manual steps needed!** Xcode's pre-build script handles:
1. Checking if Rust changed
2. Rebuilding Rust library
3. Regenerating Swift bindings
4. Compiling and running

---

## âš™ï¸ Configuration

### Signing

First time setup:
1. Open project in Xcode
2. Select **Thiccc** target
3. Go to **Signing & Capabilities**
4. Enable "Automatically manage signing"
5. Select your Apple Developer team

### Modify Project Structure

Edit `project.yml`, then:

```bash
mint run xcodegen xcodegen generate
# Xcode will prompt to reload - click "Reload"
```

### Tool Versions

**Why Mint?**
- âœ… Version pinning via `Mintfile`
- âœ… Reproducible builds across team
- âœ… Standard for Swift tools
- âœ… Isolated tool installations

Current tools in `Mintfile`:
- XcodeGen 2.42.0

---

## ğŸ†˜ Troubleshooting

### "XcodeGen not found"
```bash
brew install xcodegen
```

### "Homebrew not found"
```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

### "No such module 'SharedCore'"
Xcode's pre-build script will generate it on first build. Just hit âŒ˜B (Build).

### Pre-build script fails
Make sure Rust toolchain is installed:
```bash
rustup show
rustup target add aarch64-apple-ios-sim
```

### Files appear red in Xcode
Regenerate the project:
```bash
mint run xcodegen xcodegen generate
```

### Wrong XcodeGen version
Use the version specified in Mintfile:
```bash
mint bootstrap  # Reinstalls from Mintfile
```

---

## ğŸ“š Learn More

- **Main README**: `../../README.md` - Complete project overview
- **UniFFI Migration**: `../../UNIFFI-MIGRATION.md` - Detailed guide
- **XcodeGen**: https://github.com/yonaskolb/XcodeGen
- **TestFlight**: `../TESTFLIGHT-QUICKSTART.md` - Deployment guide

---

**Ready to deploy?** â†’ See `../TESTFLIGHT-QUICKSTART.md`

